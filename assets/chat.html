<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Chat</title>
  <link rel="stylesheet" href="katex/katex.min.css">
  <style>
    html, body { margin:0; padding:0; font-family:Segoe UI, Roboto, sans-serif; background:#f7f7f7; }
    #chat      { padding:12px; }
    .msg { max-width: 70%; margin: 6px 12px; padding:10px 14px; border-radius:12px; line-height:1.45; }
    .msg.user { background:#4285F4; color:#fff; margin-left:auto; border-bottom-right-radius:4px; }
    .msg.bot  { background:#eaeaea; color:#111; margin-right:auto; border-bottom-left-radius:4px; }
    .katex-display { margin: 8px 0; }
    .katex       { font-size: 1.05em; }
  </style>
</head>
<body>
  <div id="chat"></div>

  <script src="katex/katex.min.js"></script>
  <script src="katex/auto-render.min.js"></script>
  <script>
    function addMessage(role, text) {
      const el = document.createElement('div');
      el.className = 'msg ' + role;
      // allow HTML line breaks, then let KaTeX handle TeX blocks
      el.innerHTML = text.replace(/\n/g, '<br>');
      document.getElementById('chat').appendChild(el);

      // Render inline $...$ and display $$...$$
      renderMathInElement(el, {
        delimiters: [
          {left: "$$", right: "$$", display: true},
          {left: "$",  right: "$",  display: false}
        ],
        throwOnError: false
      });

      // scroll to bottom
      window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
    }

    // make the function visible to Qt
    window.addMessage = addMessage;
  </script>
</body>
</html>
